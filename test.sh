#!/usr/bin/env bash

curl -X POST http://localhost:8000/predict \
  -H 'Content-Type: application/json' \
  -d '{
    "src_ip": "93.127.222.13",
    "dst_ip": "192.168.0.163",
    "src_port": 59152,
    "dst_port": 22,
    "protocol": 6,
    "timestamp": "2025-05-23 13:55:03",
    "flow_duration": 20.0551495552063,
    "flow_byts_s": 323.856971603281,
    "flow_pkts_s": 2.0942252205293,
    "fwd_pkts_s": 0.8476625892618594,
    "bwd_pkts_s": 1.2465626312674403,
    "tot_fwd_pkts": 17,
    "tot_bwd_pkts": 25,
    "totlen_fwd_pkts": 2729,
    "totlen_bwd_pkts": 3766,
    "fwd_pkt_len_max": 970,
    "fwd_pkt_len_min": 66,
    "fwd_pkt_len_mean": 160.52941176470588,
    "fwd_pkt_len_std": 205.0991489491216,
    "bwd_pkt_len_max": 1178,
    "bwd_pkt_len_min": 66,
    "bwd_pkt_len_mean": 150.64,
    "bwd_pkt_len_std": 233.0340541637638,
    "pkt_len_max": 1178,
    "pkt_len_min": 66,
    "pkt_len_mean": 154.64285714285714,
    "pkt_len_std": 222.20366263199813,
    "pkt_len_var": 49374.46768707484,
    "fwd_header_len": 340,
    "bwd_header_len": 500,
    "fwd_seg_size_min": 20,
    "fwd_act_data_pkts": 12,
    "flow_iat_mean": 0.48914998915137314,
    "flow_iat_max": 2.7752771377563477,
    "flow_iat_min": 0.0,
    "flow_iat_std": 0.9413892380623651,
    "fwd_iat_tot": 19.864977836608887,
    "fwd_iat_max": 3.1745097637176514,
    "fwd_iat_min": 0.0,
    "fwd_iat_mean": 1.2415611147880554,
    "fwd_iat_std": 1.3691986520399806,
    "bwd_iat_tot": 19.748795747756958,
    "bwd_iat_max": 2.7752771377563477,
    "bwd_iat_min": 0.0,
    "bwd_iat_mean": 0.8228664894898733,
    "bwd_iat_std": 1.1143497864163026,
    "fwd_psh_flags": 12,
    "bwd_psh_flags": 11,
    "fwd_urg_flags": 0,
    "bwd_urg_flags": 0,
    "fin_flag_cnt": 2,
    "syn_flag_cnt": 3,
    "rst_flag_cnt": 0,
    "psh_flag_cnt": 23,
    "ack_flag_cnt": 40,
    "urg_flag_cnt": 0,
    "ece_flag_cnt": 0,
    "down_up_ratio": 1.4705882352941178,
    "pkt_size_avg": 154.64285714285714,
    "init_fwd_win_byts": 64240,
    "init_bwd_win_byts": 28960,
    "active_max": 0,
    "active_min": 0,
    "active_mean": 0,
    "active_std": 0,
    "idle_max": 0,
    "idle_min": 0,
    "idle_mean": 0,
    "idle_std": 0,
    "fwd_byts_b_avg": 0,
    "fwd_pkts_b_avg": 0,
    "bwd_byts_b_avg": 0,
    "bwd_pkts_b_avg": 0,
    "fwd_blk_rate_avg": 0,
    "bwd_blk_rate_avg": 0,
    "fwd_seg_size_avg": 160.52941176470588,
    "bwd_seg_size_avg": 150.64,
    "cwr_flag_count": 0,
    "subflow_fwd_pkts": 17,
    "subflow_bwd_pkts": 25,
    "subflow_fwd_byts": 2729,
    "subflow_bwd_byts": 3766
  }' -sS | jq
