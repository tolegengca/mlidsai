#!/usr/bin/env bash

curl -X POST http://localhost:8000/predict \
  -H 'Content-Type: application/json' \
  -d '{
    "src_ip": "149.154.162.123",
    "dst_ip": "192.168.0.163",
    "src_port": 48378,
    "dst_port": 443,
    "protocol": 6,
    "timestamp": "2025-05-23 13:54:58",
    "flow_duration": 15.549089193344116,
    "flow_byts_s": 1053.6308459155823,
    "flow_pkts_s": 2.057998356180103,
    "fwd_pkts_s": 0.9646867294594235,
    "bwd_pkts_s": 1.09331162672068,
    "tot_fwd_pkts": 15,
    "tot_bwd_pkts": 17,
    "totlen_fwd_pkts": 1886,
    "totlen_bwd_pkts": 14497,
    "fwd_pkt_len_max": 375,
    "fwd_pkt_len_min": 66,
    "fwd_pkt_len_mean": 125.73333333333333,
    "fwd_pkt_len_std": 101.99965141552636,
    "bwd_pkt_len_max": 1294,
    "bwd_pkt_len_min": 66,
    "bwd_pkt_len_mean": 852.7647058823529,
    "bwd_pkt_len_std": 542.9471352677917,
    "pkt_len_max": 1294,
    "pkt_len_min": 66,
    "pkt_len_mean": 511.96875,
    "pkt_len_std": 541.3985064381296,
    "pkt_len_var": 293112.3427734375,
    "fwd_header_len": 300,
    "bwd_header_len": 340,
    "fwd_seg_size_min": 20,
    "fwd_act_data_pkts": 4,
    "flow_iat_mean": 0.5015835223659393,
    "flow_iat_max": 9.744333982467651,
    "flow_iat_min": 0.0,
    "flow_iat_std": 1.9036395681712688,
    "fwd_iat_tot": 15.549089193344116,
    "fwd_iat_max": 9.744333982467651,
    "fwd_iat_min": 0.0,
    "fwd_iat_mean": 1.1106492280960083,
    "fwd_iat_std": 2.7378960491316833,
    "bwd_iat_tot": 15.441941499710083,
    "bwd_iat_max": 9.992526769638062,
    "bwd_iat_min": 0.0,
    "bwd_iat_mean": 0.9651213437318802,
    "bwd_iat_std": 2.6351250950058485,
    "fwd_psh_flags": 4,
    "bwd_psh_flags": 9,
    "fwd_urg_flags": 0,
    "bwd_urg_flags": 0,
    "fin_flag_cnt": 2,
    "syn_flag_cnt": 3,
    "rst_flag_cnt": 0,
    "psh_flag_cnt": 13,
    "ack_flag_cnt": 30,
    "urg_flag_cnt": 0,
    "ece_flag_cnt": 0,
    "down_up_ratio": 1.1333333333333333,
    "pkt_size_avg": 511.96875,
    "init_fwd_win_byts": 64240,
    "init_bwd_win_byts": 65535,
    "active_max": 0,
    "active_min": 0,
    "active_mean": 0,
    "active_std": 0,
    "idle_max": 0,
    "idle_min": 0,
    "idle_mean": 0,
    "idle_std": 0,
    "fwd_byts_b_avg": 0,
    "fwd_pkts_b_avg": 0,
    "bwd_byts_b_avg": 13061.0,
    "bwd_pkts_b_avg": 12.0,
    "fwd_blk_rate_avg": 0,
    "bwd_blk_rate_avg": 644802.840711402,
    "fwd_seg_size_avg": 125.73333333333333,
    "bwd_seg_size_avg": 852.7647058823529,
    "cwr_flag_count": 0,
    "subflow_fwd_pkts": 15,
    "subflow_bwd_pkts": 17,
    "subflow_fwd_byts": 1886,
    "subflow_bwd_byts": 14497
  }' -sS | jq
